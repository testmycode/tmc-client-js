(()=>{var __webpack_modules__={358:()=>{!function(){"use strict";if(!self.fetch){i.prototype.append=function(e,t){e=n(e),t=o(t);var r=this.map[e];r||(r=[],this.map[e]=r),r.push(t)},i.prototype.delete=function(e){delete this.map[n(e)]},i.prototype.get=function(e){var t=this.map[n(e)];return t?t[0]:null},i.prototype.getAll=function(e){return this.map[n(e)]||[]},i.prototype.has=function(e){return this.map.hasOwnProperty(n(e))},i.prototype.set=function(e,t){this.map[n(e)]=[o(t)]},i.prototype.forEach=function(e){var t=this;Object.getOwnPropertyNames(this.map).forEach((function(r){e(r,t.map[r])}))};var e={blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self},t=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],r=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);c.call(f.prototype),c.call(h.prototype),self.Headers=i,self.Request=f,self.Response=h,self.fetch=function(t,n){var o;return o=f.prototype.isPrototypeOf(t)&&!n?t:new f(t,n),new fetch.Promise((function(t,n){var i=function(){return r&&!/^(get|post|head|put|delete|options)$/i.test(this.method)?(this.usingActiveXhr=!0,new ActiveXObject("Microsoft.XMLHTTP")):new XMLHttpRequest}();function s(){if(4===i.readyState){var e=1223===i.status?204:i.status;if(e<100||e>599)n(new TypeError("Network request failed"));else{var r={status:e,statusText:i.statusText,headers:p(i),url:"responseURL"in i?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):void 0},o="response"in i?i.response:i.responseText;t(new h(o,r))}}}"cors"===o.credentials&&(i.withCredentials=!0),i.onreadystatechange=s,self.usingActiveXhr||(i.onload=s,i.onerror=function(){n(new TypeError("Network request failed"))}),i.open(o.method,o.url,!0),"responseType"in i&&e.blob&&(i.responseType="blob"),o.headers.forEach((function(e,t){t.forEach((function(t){i.setRequestHeader(e,t)}))})),i.send(void 0===o._bodyInit?null:o._bodyInit)}))},fetch.Promise=self.Promise,self.fetch.polyfill=!0}function n(e){if("string"!=typeof e&&(e=e.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function o(e){return"string"!=typeof e&&(e=e.toString()),e}function i(e){this.map={};var t=this;e instanceof i?e.forEach((function(e,r){r.forEach((function(r){t.append(e,r)}))})):e&&Object.getOwnPropertyNames(e).forEach((function(r){t.append(r,e[r])}))}function s(e){if(e.bodyUsed)return fetch.Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function a(e){return new fetch.Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function u(e){var t=new FileReader;return t.readAsArrayBuffer(e),a(t)}function c(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(e.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(e.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else{if(t)throw new Error("unsupported BodyInit type");this._bodyText=""}},e.blob?(this.blob=function(){var e=s(this);if(e)return e;if(this._bodyBlob)return fetch.Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return fetch.Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(u)},this.text=function(){var e,t,r=s(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,(t=new FileReader).readAsText(e),a(t);if(this._bodyFormData)throw new Error("could not read FormData body as text");return fetch.Promise.resolve(this._bodyText)}):this.text=function(){var e=s(this);return e||fetch.Promise.resolve(this._bodyText)},e.formData&&(this.formData=function(){return this.text().then(l)}),this.json=function(){return this.text().then((function(e){return JSON.parse(e)}))},this}function f(e,r){var n,o;if(r=r||{},this.url=e,this.credentials=r.credentials||"omit",this.headers=new i(r.headers),this.method=(n=r.method||"GET",o=n.toUpperCase(),t.indexOf(o)>-1?o:n),this.mode=r.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r.body)}function l(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function p(e){var t=new i;return e.getAllResponseHeaders().trim().split("\n").forEach((function(e){var r=e.trim().split(":"),n=r.shift().trim(),o=r.join(":").trim();t.append(n,o)})),t}function h(e,t){t||(t={}),this._initBody(e),this.type="default",this.url=null,this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof i?t.headers:new i(t.headers),this.url=t.url||""}}()},971:(e,t,r)=>{var n=r(195),o=r(15),i=[r(257)];e.exports=n.createStore(o,i)},257:(e,t,r)=>{e.exports=function(){return r(703),{}}},703:()=>{"object"!=typeof JSON&&(JSON={}),function(){"use strict";var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,(function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function str(e,t){var r,n,o,i,s,a=gap,u=t[e];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(e)),"function"==typeof rep&&(u=rep.call(t,e,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(u)){for(i=u.length,r=0;r<i;r+=1)s[r]=str(r,u)||"null";return o=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,o}if(rep&&"object"==typeof rep)for(i=rep.length,r=0;r<i;r+=1)"string"==typeof rep[r]&&(o=str(n=rep[r],u))&&s.push(quote(n)+(gap?": ":":")+o);else for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(o=str(n,u))&&s.push(quote(n)+(gap?": ":":")+o);return o=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,r){var n;if(gap="",indent="","number"==typeof r)for(n=0;n<r;n+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var r,n,o=e[t];if(o&&"object"==typeof o)for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(void 0!==(n=walk(o,r))?o[r]=n:delete o[r]);return reviver.call(e,t,o)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()},195:(e,t,r)=>{var n=r(78),o=n.slice,i=n.pluck,s=n.each,a=n.bind,u=n.create,c=n.isList,f=n.isFunction,l=n.isObject;e.exports={createStore:h};var p={version:"2.0.12",enabled:!1,get:function(e,t){var r=this.storage.read(this._namespacePrefix+e);return this._deserialize(r,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each((function(r,n){e.call(t,t._deserialize(r),(n||"").replace(t._namespaceRegexp,""))}))},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return h.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return h(this.storage,this.plugins,e)}};function h(e,t,r){r||(r=""),e&&!c(e)&&(e=[e]),t&&!c(t)&&(t=[t]);var n=r?"__storejs_"+r+"_":"",h=r?new RegExp("^"+n):null;if(!/^[a-zA-Z0-9_\-]*$/.test(r))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var d={_namespacePrefix:n,_namespaceRegexp:h,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var r=e.read(t)===t;return e.remove(t),r}catch(e){return!1}},_assignPluginFnProp:function(e,t){var r=this[t];this[t]=function(){var t=o(arguments,0),n=this;var i=[function(){if(r)return s(arguments,(function(e,r){t[r]=e})),r.apply(n,t)}].concat(t);return e.apply(n,i)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var r="";try{r=JSON.parse(e)}catch(t){r=e}return void 0!==r?r:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if(c(e))s(e,(function(e){t._addPlugin(e)}));else if(!i(this.plugins,(function(t){return e===t}))){if(this.plugins.push(e),!f(e))throw new Error("Plugins must be function values that return objects");var r=e.call(this);if(!l(r))throw new Error("Plugins must return an object of function properties");s(r,(function(r,n){if(!f(r))throw new Error("Bad plugin property: "+n+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(r,n)}))}},addStorage:function(e){!function(){var e="undefined"==typeof console?null:console;e&&(e.warn?e.warn:e.log).apply(e,arguments)}("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},_=u(d,p,{plugins:[]});return _.raw={},s(_,(function(e,t){f(e)&&(_.raw[t]=a(_,e))})),s(e,(function(e){_._addStorage(e)})),s(t,(function(e){_._addPlugin(e)})),_}},78:e=>{var t=Object.assign?Object.assign:function(e,t,r,n){for(var o=1;o<arguments.length;o++)s(Object(arguments[o]),(function(t,r){e[r]=t}));return e},r=function(){if(Object.create)return function(e,r,n,o){var s=i(arguments,1);return t.apply(this,[Object.create(e)].concat(s))};{function e(){}return function(r,n,o,s){var a=i(arguments,1);return e.prototype=r,t.apply(this,[new e].concat(a))}}}(),n=String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},o="undefined"!=typeof window?window:global;function i(e,t){return Array.prototype.slice.call(e,t||0)}function s(e,t){a(e,(function(e,r){return t(e,r),!1}))}function a(e,t){if(u(e)){for(var r=0;r<e.length;r++)if(t(e[r],r))return e[r]}else for(var n in e)if(e.hasOwnProperty(n)&&t(e[n],n))return e[n]}function u(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}e.exports={assign:t,create:r,trim:n,bind:function(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}},slice:i,each:s,map:function(e,t){var r=u(e)?[]:{};return a(e,(function(e,n){return r[n]=t(e,n),!1})),r},pluck:a,isList:u,isFunction:function(e){return e&&"[object Function]"==={}.toString.call(e)},isObject:function(e){return e&&"[object Object]"==={}.toString.call(e)},Global:o}},15:(e,t,r)=>{e.exports=[r(627),r(347),r(524),r(580),r(855),r(728)]},580:(e,t,r)=>{var n=r(78),o=n.Global,i=n.trim;e.exports={name:"cookieStorage",read:function(e){if(!e||!c(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(s.cookie.replace(new RegExp(t),"$1"))},write:function(e,t){if(!e)return;s.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/"},each:a,remove:u,clearAll:function(){a((function(e,t){u(t)}))}};var s=o.document;function a(e){for(var t=s.cookie.split(/; ?/g),r=t.length-1;r>=0;r--)if(i(t[r])){var n=t[r].split("="),o=unescape(n[0]);e(unescape(n[1]),o)}}function u(e){e&&c(e)&&(s.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function c(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(s.cookie)}},627:(e,t,r)=>{var n=r(78).Global;function o(){return n.localStorage}function i(e){return o().getItem(e)}e.exports={name:"localStorage",read:i,write:function(e,t){return o().setItem(e,t)},each:function(e){for(var t=o().length-1;t>=0;t--){var r=o().key(t);e(i(r),r)}},remove:function(e){return o().removeItem(e)},clearAll:function(){return o().clear()}}},728:e=>{e.exports={name:"memoryStorage",read:function(e){return t[e]},write:function(e,r){t[e]=r},each:function(e){for(var r in t)t.hasOwnProperty(r)&&e(t[r],r)},remove:function(e){delete t[e]},clearAll:function(e){t={}}};var t={}},347:(e,t,r)=>{var n=r(78).Global;e.exports={name:"oldFF-globalStorage",read:function(e){return o[e]},write:function(e,t){o[e]=t},each:i,remove:function(e){return o.removeItem(e)},clearAll:function(){i((function(e,t){delete o[e]}))}};var o=n.globalStorage;function i(e){for(var t=o.length-1;t>=0;t--){var r=o.key(t);e(o[r],r)}}},524:(e,t,r)=>{var n=r(78).Global;e.exports={name:"oldIE-userDataStorage",write:function(e,t){if(a)return;var r=c(e);s((function(e){e.setAttribute(r,t),e.save(o)}))},read:function(e){if(a)return;var t=c(e),r=null;return s((function(e){r=e.getAttribute(t)})),r},each:function(e){s((function(t){for(var r=t.XMLDocument.documentElement.attributes,n=r.length-1;n>=0;n--){var o=r[n];e(t.getAttribute(o.name),o.name)}}))},remove:function(e){var t=c(e);s((function(e){e.removeAttribute(t),e.save(o)}))},clearAll:function(){s((function(e){var t=e.XMLDocument.documentElement.attributes;e.load(o);for(var r=t.length-1;r>=0;r--)e.removeAttribute(t[r].name);e.save(o)}))}};var o="storejs",i=n.document,s=function(){if(!i||!i.documentElement||!i.documentElement.addBehavior)return null;var e,t,r,n="script";try{(t=new ActiveXObject("htmlfile")).open(),t.write("<"+n+">document.w=window</"+n+'><iframe src="/favicon.ico"></iframe>'),t.close(),e=t.w.frames[0].document,r=e.createElement("div")}catch(t){r=i.createElement("div"),e=i.body}return function(t){var n=[].slice.call(arguments,0);n.unshift(r),e.appendChild(r),r.addBehavior("#default#userData"),r.load(o),t.apply(this,n),e.removeChild(r)}}(),a=(n.navigator?n.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);var u=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function c(e){return e.replace(/^\d/,"___$&").replace(u,"___")}},855:(e,t,r)=>{var n=r(78).Global;function o(){return n.sessionStorage}function i(e){return o().getItem(e)}e.exports={name:"sessionStorage",read:i,write:function(e,t){return o().setItem(e,t)},each:function(e){for(var t=o().length-1;t>=0;t--){var r=o().key(t);e(i(r),r)}},remove:function(e){return o().removeItem(e)},clearAll:function(){return o().clear()}}},609:()=>{self.fetch||(self.fetch=function(e,t){return t=t||{},new Promise((function(r,n){var o=new XMLHttpRequest,i=[],s={},a=function e(){return{ok:2==(o.status/100|0),statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:e,headers:{keys:function(){return i},entries:function(){return i.map((function(e){return[e,o.getResponseHeader(e)]}))},get:function(e){return o.getResponseHeader(e)},has:function(e){return null!=o.getResponseHeader(e)}}}};for(var u in o.open(t.method||"get",e,!0),o.onload=function(){o.getAllResponseHeaders().toLowerCase().replace(/^(.+?):/gm,(function(e,t){s[t]||i.push(s[t]=t)})),r(a())},o.onerror=n,o.withCredentials="include"==t.credentials,t.headers)o.setRequestHeader(u,t.headers[u]);o.send(t.body||null)}))})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>s});var e=__webpack_require__(971),t=__webpack_require__.n(e);function r(){return t().get("tmc.user")}function n(e){t().set("tmc.user",e)}class o{constructor(e){this.oauthSite=e}request(e,t={}){let n=t.headers||{};const o=r();if(o&&o.accessToken||t.accessToken){const e=o&&o.accessToken||t.accessToken;n=Object.assign({authorization:"Bearer "+e,"Content-Type":"application/json"},n)}return fetch(new Request(this.oauthSite+e,Object.assign({mode:"cors"},t,{headers:n}))).then((e=>e.ok?Promise.resolve(e):Promise.reject(e)))}post(e,t={}){return this.request(e,Object.assign({},t,{method:"POST"}))}get(e,t={}){return this.request(e,Object.assign({},t,{method:"GET"}))}}const i=class{constructor(e,t,r="https://tmc.mooc.fi"){this.clientId=e,this.clientSecret=t,this.api=new o(r)}authenticate(e){const{username:t,password:r}=e;return new Promise(((e,o)=>{const i={headers:{"Content-Type":"application/x-www-form-urlencoded"},body:["client_id="+this.clientId,"client_secret="+this.clientSecret,"username="+encodeURIComponent(t),"password="+encodeURIComponent(r),"grant_type=password"].join("&")};this.api.post("/oauth/token",i).then((e=>e.json())).then((r=>{const o={username:t,accessToken:r.access_token};-1!==t.indexOf("@")?this.api.get("/api/v8/users/current",{accessToken:r.access_token}).then((e=>e.json())).then((t=>{o.username=t.username,n(o),e(o)})):(n(o),e(o))})).catch(o)}))}unauthenticate(){return t().remove("tmc.user"),this}getUser(){return r()}getUserDetails(){return new Promise(((e,t)=>{this.api.get("/api/v8/users/current?show_user_fields=true").then((e=>e.json())).then(e).catch(t)}))}};try{__webpack_require__(358),__webpack_require__(609)}catch(e){}const s=i})(),exports.default=__webpack_exports__.default,Object.defineProperty(exports,"__esModule",{value:!0})})();
//# sourceMappingURL=tmc-client.common.js.map